# 撤销操作

## ## 撤销提交

### 撤销提交 `git revert head`

- 在当前的提交后面添加一次提交，用于抵消上一次的提交，会保存提交日志，但是不会改变内容

- 抵消多个提交需求需要在命令后面依次指定这些提交
  - `git revert [第一个提交] [第二个提交]`

- 可选命令参数
  - `--no-edit` 自动生成提交信息
  - `--no-commit` 只恢复文件变化，不产生提交

### 丢弃提交 `git reset`

- 使用方式 `git reset SHA`
  - `git reset` 命令默认不会改变工作区的文件，只改变暂存区。`--hard` 参数可以让工作区的文件也回到以前的状态
  - `git reset` 之后被丢弃的文件可以使用`git reflog`命令找回

### 替换提交 `git commit --amend`

- `--amend`参数用于产生一个新的提交，覆盖上一次的提交，不仅可以修改提交信息，还可以将暂存区的内容一起提交

### 撤销文件修改 `git checkout --[fileName]`

- 如果存在暂存区的文件则回退到暂存区的版本，没有则回退到上一个commit

### 从暂存区撤销 `git rm --cached [filename]`

- 从暂存区撤销，`git add` 命令的逆操作

### 撤销当前分支的变化

- 当前分支上做了几次提交，突然发现放错了分支，这几个提交本应该放到另一个分支

``` bash
# 新建一个 feature 分支，指向当前最新的提交
# 注意，这时依然停留在当前分支
$ git branch feature

# 切换到这几次提交之前的状态
$ git reset --hard [当前分支此前的最后一次提交]

# 切换到 feature 分支
$ git checkout feature
```

### 编辑分支错误

> 在一个不应该修改的分支上面做了大量修改，需要将这些修改转移到其它分支

- 解决办法

```shell
# 把暂存区的内容存储起来
git stash
# 切换分支
git checkout xxx
# 读取存储区内容
git stash pop
# ... 愉快的继续操作
```
